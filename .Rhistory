activities <- read.csv(unz("activity.zip", "activity.csv"))
activitiesComplete <- activities[complete.cases(activities), ]
activities <- read.csv(unz("./activity.zip", "./activity.csv"))
activities <- read.csv(unz("./activity.zip", "activity.csv"))
#activities <- read.csv("./activity.csv")
activitiesComplete <- activities[complete.cases(activities), ]
library(plyr)
library(ggplot2)
stepsPerDay <- aggregate(steps ~ date, activitiesComplete, sum)
hist(stepsPerDay$steps, main = "Steps per day", xlab = "Steps", col = "green", breaks = 8)
hist(stepsPerDay$steps, main = "Number of steps per day", xlab = "Steps", col = "blue", breaks = 8)
activity$fechayhora <- as.POSIXct(with(activity, paste(date, paste(interval %/% 100, interval %% 100, sep=":"))),format="%Y-%m-%d %H:%M",tz="")
meanStepsPerDay <- mean(stepsPerDay$steps)
medianStepsPerDay <- median(stepsPerDay$steps)
stepsInterval <- aggregate(steps ~ interval, activitiesComplete, mean)
plot(stepsInterval$interval, stepsInterval$steps, type="l", xlab = "5-minute interval", ylab = "Average steps", main = "Average Daily Activity Pattern", col = "blue")
stepsInterval <- aggregate(steps ~ interval, activitiesComplete, mean)
